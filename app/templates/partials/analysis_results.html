<h2>{{ analysis.title }}</h2>

{% if insights_enabled %}
<article id="cluster-insights"
         hx-get="/api/analysis/{{ analysis.id }}/insights"
         hx-trigger="load"
         hx-swap="innerHTML">
    <p aria-busy="true">Generating insights...</p>
</article>
{% endif %}

<!-- Save button -->
<div style="margin-top: 1rem; text-align: center;">
    <button hx-post="/api/analysis/{{ analysis.id }}/save"
            hx-target="#save-status"
            hx-swap="innerHTML">
        Save Analysis
    </button>
    <div id="save-status" style="margin-top: 0.5rem;"></div>
</div>

<!-- Tab bar -->
<div class="analysis-tabs" role="tablist" aria-label="Analysis sections">
    <button role="tab" aria-selected="false" aria-controls="tab-preprocessing"
            data-tab="preprocessing" class="tab-btn">Pre-Processing</button>
    <button role="tab" aria-selected="true" aria-controls="tab-eda"
            data-tab="eda" class="tab-btn active">EDA</button>
    <button role="tab" aria-selected="false" aria-controls="tab-segmentation"
            data-tab="segmentation" class="tab-btn">Segmentation</button>
</div>

<!-- Tab panels â€” all rendered inline, toggled via JS -->
<div id="tab-preprocessing" role="tabpanel" class="tab-panel" style="display: none;">
    {% include "partials/section_preprocessing.html" %}
</div>

<div id="tab-eda" role="tabpanel" class="tab-panel">
    {% include "partials/section_eda.html" %}
</div>

<div id="tab-segmentation" role="tabpanel" class="tab-panel" style="display: none;">
    {% include "partials/section_segmentation.html" %}
</div>
